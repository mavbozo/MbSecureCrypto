{"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/MbSecureCrypto\/documentation\/MbSecureCrypto\/CipherFormat"},"kind":"article","hierarchy":{"paths":[["doc:\/\/MbSecureCrypto\/documentation\/MbSecureCrypto"]]},"sections":[],"metadata":{"role":"article","roleHeading":"Article","title":"Cipher Format","modules":[{"name":"MbSecureCrypto"}]},"primaryContentSections":[{"content":[{"text":"Format V0 Specification","type":"heading","level":2,"anchor":"Format-V0-Specification"},{"type":"paragraph","inlineContent":[{"text":"Format V0 (Default)","type":"text"}]},{"type":"paragraph","inlineContent":[{"text":"Used in versions 0.3.0 and earlier","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The V0 format is structured as follows:"}]},{"type":"codeListing","syntax":null,"code":["[12-byte nonce][ciphertext][16-byte tag]"]},{"inlineContent":[{"text":"Key characteristics:","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Nonce: 12 bytes, randomly generated","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Total overhead: 28 bytes per encrypted output"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Base64 encoded for string operations"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Raw bytes for data\/file operations","type":"text"}]}]},{"content":[{"inlineContent":[{"text":"No explicit version or algorithm indicators","type":"text"}],"type":"paragraph"}]}]},{"level":2,"anchor":"Format-V1-Specification","type":"heading","text":"Format V1 Specification"},{"level":3,"type":"heading","anchor":"Format-Structure","text":"Format Structure"},{"inlineContent":[{"text":"The cipher format consists of the following components in order:","type":"text"}],"type":"paragraph"},{"syntax":null,"code":["[MAGIC_BYTES (4)][VERSION (1)][ALGORITHM (1)][PARAMS_LENGTH (2)][ALGORITHM_PARAMS (variable)][CIPHERTEXT (variable)][AUTH_TAG (optional)]"],"type":"codeListing"},{"level":4,"text":"Header Format (Fixed 8 bytes)","anchor":"Header-Format-Fixed-8-bytes","type":"heading"},{"type":"table","header":"row","rows":[[[{"type":"paragraph","inlineContent":[{"text":"Field","type":"text"}]}],[{"inlineContent":[{"type":"text","text":"Size (bytes)"}],"type":"paragraph"}],[{"inlineContent":[{"text":"Description","type":"text"}],"type":"paragraph"}]],[[{"inlineContent":[{"type":"text","text":"MAGIC_BYTES"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"4"}]}],[{"type":"paragraph","inlineContent":[{"text":"ASCII “SECB” (SECure Block)","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"VERSION"}]}],[{"inlineContent":[{"text":"1","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"Format version (current: 0x01)","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"text":"ALGORITHM","type":"text"}]}],[{"inlineContent":[{"type":"text","text":"1"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Algorithm identifier"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"PARAMS_LENGTH"}]}],[{"type":"paragraph","inlineContent":[{"text":"2","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"text":"Length of algorithm parameters (big-endian)","type":"text"}]}]]]},{"text":"Algorithm Identifiers","type":"heading","anchor":"Algorithm-Identifiers","level":4},{"header":"row","type":"table","rows":[[[{"type":"paragraph","inlineContent":[{"type":"text","text":"Algorithm"}]}],[{"type":"paragraph","inlineContent":[{"text":"ID","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"IV Required"}]}],[{"type":"paragraph","inlineContent":[{"text":"Auth Tag","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"text":"Description","type":"text"}]}]],[[{"inlineContent":[{"type":"text","text":"AES-GCM"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"0x01"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Yes"}]}],[{"inlineContent":[{"type":"text","text":"Yes"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"AES in GCM mode"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"AES-CBC"}]}],[{"inlineContent":[{"text":"0x02","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Yes"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"No"}],"type":"paragraph"}],[{"inlineContent":[{"text":"AES in CBC mode","type":"text"}],"type":"paragraph"}]],[[{"inlineContent":[{"text":"AES-CTR","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"0x03","type":"text"}]}],[{"inlineContent":[{"type":"text","text":"Yes"}],"type":"paragraph"}],[{"inlineContent":[{"text":"No","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"AES in CTR mode"}],"type":"paragraph"}]],[[{"type":"paragraph","inlineContent":[{"text":"ChaCha20-Poly1305","type":"text"}]}],[{"inlineContent":[{"text":"0x11","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"text":"Yes","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"Yes","type":"text"}]}],[{"inlineContent":[{"type":"text","text":"ChaCha20 with Poly1305"}],"type":"paragraph"}]]]},{"anchor":"Algorithm-Parameters","level":4,"text":"Algorithm Parameters","type":"heading"},{"level":5,"anchor":"AES-GCM-16-bytes","type":"heading","text":"AES-GCM (16 bytes)"},{"rows":[[[{"type":"paragraph","inlineContent":[{"text":"Field","type":"text"}]}],[{"inlineContent":[{"type":"text","text":"Size (bytes)"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Description"}],"type":"paragraph"}]],[[{"inlineContent":[{"type":"text","text":"IV"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"12"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Initialization Vector"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"TAG_LENGTH"}]}],[{"inlineContent":[{"text":"4","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Auth tag length in bits"}]}]]],"type":"table","header":"row"},{"text":"AES-CBC (16 bytes)","anchor":"AES-CBC-16-bytes","level":5,"type":"heading"},{"rows":[[[{"inlineContent":[{"text":"Field","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"Size (bytes)","type":"text"}]}],[{"inlineContent":[{"text":"Description","type":"text"}],"type":"paragraph"}]],[[{"inlineContent":[{"text":"IV","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"16","type":"text"}]}],[{"inlineContent":[{"type":"text","text":"Initialization Vector"}],"type":"paragraph"}]]],"type":"table","header":"row"},{"text":"ChaCha20-Poly1305 (16 bytes)","type":"heading","level":5,"anchor":"ChaCha20-Poly1305-16-bytes"},{"header":"row","rows":[[[{"inlineContent":[{"text":"Field","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"Size (bytes)","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Description"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"NONCE"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"12"}]}],[{"type":"paragraph","inlineContent":[{"text":"Nonce value","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"COUNTER"}]}],[{"inlineContent":[{"text":"4","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"text":"Initial counter value","type":"text"}],"type":"paragraph"}]]],"type":"table"},{"anchor":"Version-History","text":"Version History","level":3,"type":"heading"},{"type":"table","header":"row","rows":[[[{"type":"paragraph","inlineContent":[{"text":"Version","type":"text"}]}],[{"inlineContent":[{"type":"text","text":"Description"}],"type":"paragraph"}]],[[{"inlineContent":[{"text":"0x01","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Initial version with AES-GCM support"}],"type":"paragraph"}]]]},{"text":"Format Details","type":"heading","anchor":"Format-Details","level":3},{"anchor":"Magic-Bytes","level":4,"type":"heading","text":"Magic Bytes"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"Fixed value: “SECB” (0x53454342)","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Used to identify the format and detect corruption","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"ASCII encoded for easy identification","type":"text"}]}]}]},{"type":"heading","text":"Version Byte","level":4,"anchor":"Version-Byte"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Current version: 0x01"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Future versions must maintain backward compatibility"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Readers must reject higher versions they don’t understand"}]}]}],"type":"unorderedList"},{"anchor":"Algorithm-ID","text":"Algorithm ID","level":4,"type":"heading"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Single byte identifier for the cipher algorithm","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Defines required parameters and authentication tag presence"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Reserved ranges:"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"0x00: Reserved"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"0x01-0x0F: AES variants","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"0x10-0x1F: ChaCha20 variants"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"0x20-0xFF: Reserved for future use"}],"type":"paragraph"}]}]}]}]},{"anchor":"Parameters-Length","type":"heading","level":4,"text":"Parameters Length"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"2-byte unsigned integer (big-endian)"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Maximum parameter size: 65535 bytes"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Must match the expected size for the algorithm","type":"text"}]}]}],"type":"unorderedList"},{"level":4,"text":"Authentication Tag","anchor":"Authentication-Tag","type":"heading"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Only present for authenticated ciphers (GCM, Poly1305)"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Always appears at the end of the ciphertext","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Size determined by algorithm and parameters"}]}]}],"type":"unorderedList"}],"kind":"content"}],"schemaVersion":{"minor":3,"major":0,"patch":0},"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/mbsecurecrypto\/cipherformat"]},{"traits":[{"interfaceLanguage":"occ"}],"paths":["\/documentation\/mbsecurecrypto\/cipherformat"]}],"references":{"doc://MbSecureCrypto/documentation/MbSecureCrypto":{"title":"MbSecureCrypto","identifier":"doc:\/\/MbSecureCrypto\/documentation\/MbSecureCrypto","abstract":[{"type":"text","text":"A secure cryptography library for iOS and macOS that provides cryptographically secure random number generation and encryption capabilities."}],"type":"topic","url":"\/documentation\/mbsecurecrypto","role":"collection","kind":"symbol"}},"variantOverrides":[{"traits":[{"interfaceLanguage":"occ"}],"patch":[{"op":"replace","value":"occ","path":"\/identifier\/interfaceLanguage"},{"op":"add","value":null,"path":"\/topicSections"},{"op":"add","value":null,"path":"\/seeAlsoSections"}]}]}