{"primaryContentSections":[{"kind":"content","content":[{"text":"Format V0 Specification","type":"heading","level":2,"anchor":"Format-V0-Specification"},{"inlineContent":[{"type":"text","text":"Format V0 (Default)"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Used in versions 0.3.0 and earlier"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"text","text":"The V0 format is structured as follows:"}]},{"code":["[12-byte nonce][ciphertext][16-byte tag]"],"type":"codeListing","syntax":null},{"type":"paragraph","inlineContent":[{"type":"text","text":"Key characteristics:"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Nonce: 12 bytes, randomly generated"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Total overhead: 28 bytes per encrypted output","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Base64 encoded for string operations"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Raw bytes for data\/file operations"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"No explicit version or algorithm indicators","type":"text"}]}]}]},{"anchor":"Format-V1-Specification","text":"Format V1 Specification","type":"heading","level":2},{"anchor":"Format-Structure","type":"heading","text":"Format Structure","level":3},{"inlineContent":[{"type":"text","text":"The cipher format consists of the following components in order:"}],"type":"paragraph"},{"code":["[MAGIC_BYTES (4)][VERSION (1)][ALGORITHM (1)][PARAMS_LENGTH (2)][ALGORITHM_PARAMS (variable)][CIPHERTEXT (variable)][AUTH_TAG (optional)]"],"type":"codeListing","syntax":null},{"level":4,"type":"heading","text":"Header Format (Fixed 8 bytes)","anchor":"Header-Format-Fixed-8-bytes"},{"header":"row","rows":[[[{"inlineContent":[{"text":"Field","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"Size (bytes)","type":"text"}]}],[{"inlineContent":[{"type":"text","text":"Description"}],"type":"paragraph"}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"MAGIC_BYTES"}]}],[{"type":"paragraph","inlineContent":[{"text":"4","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"ASCII “SECB” (SECure Block)"}]}]],[[{"inlineContent":[{"type":"text","text":"VERSION"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"1","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"text":"Format version (current: 0x01)","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"ALGORITHM"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"1"}]}],[{"inlineContent":[{"type":"text","text":"Algorithm identifier"}],"type":"paragraph"}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"PARAMS_LENGTH"}]}],[{"type":"paragraph","inlineContent":[{"text":"2","type":"text"}]}],[{"inlineContent":[{"type":"text","text":"Length of algorithm parameters (big-endian)"}],"type":"paragraph"}]]],"type":"table"},{"anchor":"Algorithm-Identifiers","level":4,"type":"heading","text":"Algorithm Identifiers"},{"type":"table","rows":[[[{"type":"paragraph","inlineContent":[{"text":"Algorithm","type":"text"}]}],[{"inlineContent":[{"type":"text","text":"ID"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"IV Required"}]}],[{"type":"paragraph","inlineContent":[{"text":"Auth Tag","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Description"}]}]],[[{"type":"paragraph","inlineContent":[{"text":"AES-GCM","type":"text"}]}],[{"inlineContent":[{"type":"text","text":"0x01"}],"type":"paragraph"}],[{"inlineContent":[{"text":"Yes","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"Yes","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"text":"AES in GCM mode","type":"text"}]}]],[[{"inlineContent":[{"type":"text","text":"AES-CBC"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"0x02"}],"type":"paragraph"}],[{"inlineContent":[{"text":"Yes","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"No"}]}],[{"type":"paragraph","inlineContent":[{"text":"AES in CBC mode","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"AES-CTR"}]}],[{"type":"paragraph","inlineContent":[{"text":"0x03","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"text":"Yes","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"No"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"AES in CTR mode"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"ChaCha20-Poly1305"}]}],[{"inlineContent":[{"text":"0x11","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Yes"}]}],[{"inlineContent":[{"type":"text","text":"Yes"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"ChaCha20 with Poly1305"}],"type":"paragraph"}]]],"header":"row"},{"anchor":"Algorithm-Parameters","level":4,"type":"heading","text":"Algorithm Parameters"},{"type":"heading","anchor":"AES-GCM-16-bytes","text":"AES-GCM (16 bytes)","level":5},{"rows":[[[{"type":"paragraph","inlineContent":[{"text":"Field","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Size (bytes)"}]}],[{"inlineContent":[{"text":"Description","type":"text"}],"type":"paragraph"}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"IV"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"12"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Initialization Vector"}]}]],[[{"type":"paragraph","inlineContent":[{"text":"TAG_LENGTH","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"4"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Auth tag length in bits"}]}]]],"header":"row","type":"table"},{"type":"heading","level":5,"text":"AES-CBC (16 bytes)","anchor":"AES-CBC-16-bytes"},{"type":"table","rows":[[[{"type":"paragraph","inlineContent":[{"type":"text","text":"Field"}]}],[{"type":"paragraph","inlineContent":[{"text":"Size (bytes)","type":"text"}]}],[{"inlineContent":[{"type":"text","text":"Description"}],"type":"paragraph"}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"IV"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"16"}]}],[{"inlineContent":[{"type":"text","text":"Initialization Vector"}],"type":"paragraph"}]]],"header":"row"},{"level":5,"text":"ChaCha20-Poly1305 (16 bytes)","type":"heading","anchor":"ChaCha20-Poly1305-16-bytes"},{"header":"row","rows":[[[{"inlineContent":[{"type":"text","text":"Field"}],"type":"paragraph"}],[{"inlineContent":[{"text":"Size (bytes)","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"Description","type":"text"}]}]],[[{"inlineContent":[{"type":"text","text":"NONCE"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"12"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Nonce value"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"COUNTER"}]}],[{"type":"paragraph","inlineContent":[{"text":"4","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"text":"Initial counter value","type":"text"}]}]]],"type":"table"},{"level":3,"type":"heading","text":"Version History","anchor":"Version-History"},{"header":"row","type":"table","rows":[[[{"inlineContent":[{"text":"Version","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"Description","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"0x01"}]}],[{"type":"paragraph","inlineContent":[{"text":"Initial version with AES-GCM support","type":"text"}]}]]]},{"anchor":"Format-Details","level":3,"text":"Format Details","type":"heading"},{"level":4,"anchor":"Magic-Bytes","text":"Magic Bytes","type":"heading"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"Fixed value: “SECB” (0x53454342)","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Used to identify the format and detect corruption","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"ASCII encoded for easy identification","type":"text"}]}]}]},{"type":"heading","text":"Version Byte","level":4,"anchor":"Version-Byte"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Current version: 0x01"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Future versions must maintain backward compatibility","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Readers must reject higher versions they don’t understand"}]}]}],"type":"unorderedList"},{"text":"Algorithm ID","type":"heading","level":4,"anchor":"Algorithm-ID"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Single byte identifier for the cipher algorithm"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Defines required parameters and authentication tag presence","type":"text"}]}]},{"content":[{"inlineContent":[{"text":"Reserved ranges:","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"0x00: Reserved"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"0x01-0x0F: AES variants","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"0x10-0x1F: ChaCha20 variants"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"0x20-0xFF: Reserved for future use"}],"type":"paragraph"}]}]}]}],"type":"unorderedList"},{"level":4,"anchor":"Parameters-Length","type":"heading","text":"Parameters Length"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"2-byte unsigned integer (big-endian)"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Maximum parameter size: 65535 bytes","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Must match the expected size for the algorithm","type":"text"}]}]}]},{"text":"Authentication Tag","level":4,"type":"heading","anchor":"Authentication-Tag"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Only present for authenticated ciphers (GCM, Poly1305)","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Always appears at the end of the ciphertext"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Size determined by algorithm and parameters","type":"text"}]}]}]}]}],"hierarchy":{"paths":[["doc:\/\/MbSecureCrypto\/documentation\/MbSecureCrypto"]]},"variants":[{"paths":["\/documentation\/mbsecurecrypto\/cipherformat"],"traits":[{"interfaceLanguage":"swift"}]},{"paths":["\/documentation\/mbsecurecrypto\/cipherformat"],"traits":[{"interfaceLanguage":"occ"}]}],"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/MbSecureCrypto\/documentation\/MbSecureCrypto\/CipherFormat"},"metadata":{"title":"Cipher Format","roleHeading":"Article","modules":[{"name":"MbSecureCrypto"}],"role":"article"},"schemaVersion":{"patch":0,"major":0,"minor":3},"sections":[],"kind":"article","references":{"doc://MbSecureCrypto/documentation/MbSecureCrypto":{"identifier":"doc:\/\/MbSecureCrypto\/documentation\/MbSecureCrypto","type":"topic","abstract":[{"text":"A secure cryptography library for iOS and macOS that provides cryptographically secure random number generation and encryption capabilities.","type":"text"}],"title":"MbSecureCrypto","kind":"symbol","url":"\/documentation\/mbsecurecrypto","role":"collection"}},"variantOverrides":[{"traits":[{"interfaceLanguage":"occ"}],"patch":[{"op":"replace","path":"\/identifier\/interfaceLanguage","value":"occ"},{"path":"\/topicSections","value":null,"op":"add"},{"path":"\/seeAlsoSections","value":null,"op":"add"}]}]}