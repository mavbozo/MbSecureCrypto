{"primaryContentSections":[{"kind":"content","content":[{"type":"heading","anchor":"Format-V0-Specification","level":2,"text":"Format V0 Specification"},{"inlineContent":[{"type":"text","text":"Format V0 (Default)"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Used in versions 0.3.0 and earlier"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"The V0 format is structured as follows:"}],"type":"paragraph"},{"syntax":null,"code":["[12-byte nonce][ciphertext][16-byte tag]"],"type":"codeListing"},{"type":"paragraph","inlineContent":[{"text":"Key characteristics:","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Nonce: 12 bytes, randomly generated","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Total overhead: 28 bytes per encrypted output"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Base64 encoded for string operations"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Raw bytes for data\/file operations"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"No explicit version or algorithm indicators"}]}]}]},{"text":"Format V1 Specification","level":2,"type":"heading","anchor":"Format-V1-Specification"},{"type":"heading","anchor":"Format-Structure","level":3,"text":"Format Structure"},{"type":"paragraph","inlineContent":[{"text":"The cipher format consists of the following components in order:","type":"text"}]},{"code":["[MAGIC_BYTES (4)][VERSION (1)][ALGORITHM (1)][PARAMS_LENGTH (2)][ALGORITHM_PARAMS (variable)][CIPHERTEXT (variable)][AUTH_TAG (optional)]"],"type":"codeListing","syntax":null},{"level":4,"anchor":"Header-Format-Fixed-8-bytes","text":"Header Format (Fixed 8 bytes)","type":"heading"},{"rows":[[[{"inlineContent":[{"text":"Field","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Size (bytes)"}],"type":"paragraph"}],[{"inlineContent":[{"text":"Description","type":"text"}],"type":"paragraph"}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"MAGIC_BYTES"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"4"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"ASCII “SECB” (SECure Block)"}]}]],[[{"type":"paragraph","inlineContent":[{"text":"VERSION","type":"text"}]}],[{"inlineContent":[{"type":"text","text":"1"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"Format version (current: 0x01)","type":"text"}]}]],[[{"inlineContent":[{"text":"ALGORITHM","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"1","type":"text"}]}],[{"inlineContent":[{"text":"Algorithm identifier","type":"text"}],"type":"paragraph"}]],[[{"inlineContent":[{"text":"PARAMS_LENGTH","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"2","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Length of algorithm parameters (big-endian)"}]}]]],"type":"table","header":"row"},{"text":"Algorithm Identifiers","level":4,"anchor":"Algorithm-Identifiers","type":"heading"},{"type":"table","rows":[[[{"type":"paragraph","inlineContent":[{"text":"Algorithm","type":"text"}]}],[{"inlineContent":[{"type":"text","text":"ID"}],"type":"paragraph"}],[{"inlineContent":[{"text":"IV Required","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"Auth Tag","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"text":"Description","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"text":"AES-GCM","type":"text"}]}],[{"inlineContent":[{"text":"0x01","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Yes"}]}],[{"inlineContent":[{"text":"Yes","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"AES in GCM mode"}],"type":"paragraph"}]],[[{"inlineContent":[{"text":"AES-CBC","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"0x02"}]}],[{"inlineContent":[{"type":"text","text":"Yes"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"No","type":"text"}]}],[{"inlineContent":[{"text":"AES in CBC mode","type":"text"}],"type":"paragraph"}]],[[{"inlineContent":[{"type":"text","text":"AES-CTR"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"0x03"}],"type":"paragraph"}],[{"inlineContent":[{"text":"Yes","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"No"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"AES in CTR mode","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"ChaCha20-Poly1305"}]}],[{"inlineContent":[{"text":"0x11","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Yes"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"Yes","type":"text"}]}],[{"inlineContent":[{"text":"ChaCha20 with Poly1305","type":"text"}],"type":"paragraph"}]]],"header":"row"},{"level":4,"anchor":"Algorithm-Parameters","text":"Algorithm Parameters","type":"heading"},{"level":5,"type":"heading","text":"AES-GCM (16 bytes)","anchor":"AES-GCM-16-bytes"},{"rows":[[[{"type":"paragraph","inlineContent":[{"type":"text","text":"Field"}]}],[{"inlineContent":[{"type":"text","text":"Size (bytes)"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Description"}]}]],[[{"type":"paragraph","inlineContent":[{"text":"IV","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"12"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Initialization Vector"}]}]],[[{"type":"paragraph","inlineContent":[{"text":"TAG_LENGTH","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"4"}]}],[{"inlineContent":[{"type":"text","text":"Auth tag length in bits"}],"type":"paragraph"}]]],"type":"table","header":"row"},{"type":"heading","level":5,"text":"AES-CBC (16 bytes)","anchor":"AES-CBC-16-bytes"},{"rows":[[[{"type":"paragraph","inlineContent":[{"text":"Field","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Size (bytes)"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Description"}]}]],[[{"inlineContent":[{"text":"IV","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"16"}]}],[{"inlineContent":[{"type":"text","text":"Initialization Vector"}],"type":"paragraph"}]]],"type":"table","header":"row"},{"anchor":"ChaCha20-Poly1305-16-bytes","level":5,"type":"heading","text":"ChaCha20-Poly1305 (16 bytes)"},{"header":"row","rows":[[[{"inlineContent":[{"text":"Field","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"text":"Size (bytes)","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"Description","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"NONCE"}]}],[{"type":"paragraph","inlineContent":[{"text":"12","type":"text"}]}],[{"inlineContent":[{"text":"Nonce value","type":"text"}],"type":"paragraph"}]],[[{"type":"paragraph","inlineContent":[{"text":"COUNTER","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"4"}]}],[{"type":"paragraph","inlineContent":[{"text":"Initial counter value","type":"text"}]}]]],"type":"table"},{"type":"heading","level":3,"text":"Version History","anchor":"Version-History"},{"type":"table","header":"row","rows":[[[{"type":"paragraph","inlineContent":[{"type":"text","text":"Version"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Description"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"0x01"}]}],[{"inlineContent":[{"type":"text","text":"Initial version with AES-GCM support"}],"type":"paragraph"}]]]},{"anchor":"Format-Details","level":3,"type":"heading","text":"Format Details"},{"text":"Magic Bytes","type":"heading","level":4,"anchor":"Magic-Bytes"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Fixed value: “SECB” (0x53454342)","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Used to identify the format and detect corruption","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"ASCII encoded for easy identification"}],"type":"paragraph"}]}],"type":"unorderedList"},{"level":4,"text":"Version Byte","anchor":"Version-Byte","type":"heading"},{"items":[{"content":[{"inlineContent":[{"text":"Current version: 0x01","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Future versions must maintain backward compatibility"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Readers must reject higher versions they don’t understand"}]}]}],"type":"unorderedList"},{"type":"heading","level":4,"text":"Algorithm ID","anchor":"Algorithm-ID"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Single byte identifier for the cipher algorithm"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Defines required parameters and authentication tag presence"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Reserved ranges:"}],"type":"paragraph"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"0x00: Reserved"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"0x01-0x0F: AES variants"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"0x10-0x1F: ChaCha20 variants"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"0x20-0xFF: Reserved for future use","type":"text"}]}]}],"type":"unorderedList"}]}],"type":"unorderedList"},{"type":"heading","level":4,"anchor":"Parameters-Length","text":"Parameters Length"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"2-byte unsigned integer (big-endian)"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Maximum parameter size: 65535 bytes"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Must match the expected size for the algorithm","type":"text"}]}]}],"type":"unorderedList"},{"text":"Authentication Tag","level":4,"type":"heading","anchor":"Authentication-Tag"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Only present for authenticated ciphers (GCM, Poly1305)"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Always appears at the end of the ciphertext"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Size determined by algorithm and parameters"}]}]}]}]}],"sections":[],"schemaVersion":{"patch":0,"major":0,"minor":3},"metadata":{"modules":[{"name":"MbSecureCrypto"}],"title":"Cipher Format","roleHeading":"Article","role":"article"},"variants":[{"paths":["\/documentation\/mbsecurecrypto\/cipherformat"],"traits":[{"interfaceLanguage":"swift"}]},{"traits":[{"interfaceLanguage":"occ"}],"paths":["\/documentation\/mbsecurecrypto\/cipherformat"]}],"identifier":{"url":"doc:\/\/MbSecureCrypto\/documentation\/MbSecureCrypto\/CipherFormat","interfaceLanguage":"swift"},"hierarchy":{"paths":[["doc:\/\/MbSecureCrypto\/documentation\/MbSecureCrypto"]]},"kind":"article","references":{"doc://MbSecureCrypto/documentation/MbSecureCrypto":{"abstract":[{"type":"text","text":"A secure cryptography library for iOS and macOS that provides cryptographically secure random number generation and encryption capabilities."}],"url":"\/documentation\/mbsecurecrypto","title":"MbSecureCrypto","kind":"symbol","identifier":"doc:\/\/MbSecureCrypto\/documentation\/MbSecureCrypto","role":"collection","type":"topic"}},"variantOverrides":[{"patch":[{"path":"\/identifier\/interfaceLanguage","value":"occ","op":"replace"},{"path":"\/topicSections","value":null,"op":"add"},{"path":"\/seeAlsoSections","op":"add","value":null}],"traits":[{"interfaceLanguage":"occ"}]}]}