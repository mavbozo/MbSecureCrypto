{"primaryContentSections":[{"kind":"content","content":[{"level":2,"anchor":"Format-V0-Specification","type":"heading","text":"Format V0 Specification"},{"inlineContent":[{"text":"Format V0 (Default)","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Used in versions 0.3.0 and earlier"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"text":"The V0 format is structured as follows:","type":"text"}]},{"syntax":null,"type":"codeListing","code":["[12-byte nonce][ciphertext][16-byte tag]"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Key characteristics:"}]},{"items":[{"content":[{"inlineContent":[{"text":"Nonce: 12 bytes, randomly generated","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Total overhead: 28 bytes per encrypted output","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Base64 encoded for string operations"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Raw bytes for data\/file operations"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"No explicit version or algorithm indicators"}],"type":"paragraph"}]}],"type":"unorderedList"},{"level":2,"anchor":"Format-V1-Specification","text":"Format V1 Specification","type":"heading"},{"level":3,"anchor":"Format-Structure","type":"heading","text":"Format Structure"},{"type":"paragraph","inlineContent":[{"type":"text","text":"The cipher format consists of the following components in order:"}]},{"code":["[MAGIC_BYTES (4)][VERSION (1)][ALGORITHM (1)][PARAMS_LENGTH (2)][ALGORITHM_PARAMS (variable)][CIPHERTEXT (variable)][AUTH_TAG (optional)]"],"type":"codeListing","syntax":null},{"type":"heading","level":4,"anchor":"Header-Format-Fixed-8-bytes","text":"Header Format (Fixed 8 bytes)"},{"type":"table","rows":[[[{"type":"paragraph","inlineContent":[{"type":"text","text":"Field"}]}],[{"inlineContent":[{"type":"text","text":"Size (bytes)"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Description"}]}]],[[{"type":"paragraph","inlineContent":[{"text":"MAGIC_BYTES","type":"text"}]}],[{"inlineContent":[{"text":"4","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"ASCII “SECB” (SECure Block)","type":"text"}]}]],[[{"inlineContent":[{"text":"VERSION","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"1"}]}],[{"inlineContent":[{"type":"text","text":"Format version (current: 0x01)"}],"type":"paragraph"}]],[[{"inlineContent":[{"text":"ALGORITHM","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"1","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Algorithm identifier"}]}]],[[{"inlineContent":[{"text":"PARAMS_LENGTH","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"2","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Length of algorithm parameters (big-endian)"}]}]]],"header":"row"},{"anchor":"Algorithm-Identifiers","text":"Algorithm Identifiers","type":"heading","level":4},{"type":"table","header":"row","rows":[[[{"type":"paragraph","inlineContent":[{"type":"text","text":"Algorithm"}]}],[{"type":"paragraph","inlineContent":[{"text":"ID","type":"text"}]}],[{"inlineContent":[{"type":"text","text":"IV Required"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"Auth Tag","type":"text"}]}],[{"inlineContent":[{"type":"text","text":"Description"}],"type":"paragraph"}]],[[{"type":"paragraph","inlineContent":[{"text":"AES-GCM","type":"text"}]}],[{"inlineContent":[{"type":"text","text":"0x01"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Yes"}]}],[{"inlineContent":[{"text":"Yes","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"text":"AES in GCM mode","type":"text"}],"type":"paragraph"}]],[[{"inlineContent":[{"text":"AES-CBC","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"0x02"}]}],[{"inlineContent":[{"text":"Yes","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"No"}]}],[{"type":"paragraph","inlineContent":[{"text":"AES in CBC mode","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"text":"AES-CTR","type":"text"}]}],[{"inlineContent":[{"type":"text","text":"0x03"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Yes"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"No"}]}],[{"inlineContent":[{"type":"text","text":"AES in CTR mode"}],"type":"paragraph"}]],[[{"type":"paragraph","inlineContent":[{"text":"ChaCha20-Poly1305","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"0x11"}]}],[{"inlineContent":[{"text":"Yes","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Yes"}]}],[{"inlineContent":[{"type":"text","text":"ChaCha20 with Poly1305"}],"type":"paragraph"}]]]},{"anchor":"Algorithm-Parameters","text":"Algorithm Parameters","level":4,"type":"heading"},{"anchor":"AES-GCM-16-bytes","level":5,"type":"heading","text":"AES-GCM (16 bytes)"},{"rows":[[[{"type":"paragraph","inlineContent":[{"text":"Field","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Size (bytes)"}]}],[{"inlineContent":[{"type":"text","text":"Description"}],"type":"paragraph"}]],[[{"inlineContent":[{"text":"IV","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"12"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Initialization Vector"}]}]],[[{"type":"paragraph","inlineContent":[{"text":"TAG_LENGTH","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"text":"4","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Auth tag length in bits"}]}]]],"type":"table","header":"row"},{"type":"heading","anchor":"AES-CBC-16-bytes","level":5,"text":"AES-CBC (16 bytes)"},{"type":"table","rows":[[[{"inlineContent":[{"text":"Field","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"Size (bytes)","type":"text"}]}],[{"inlineContent":[{"text":"Description","type":"text"}],"type":"paragraph"}]],[[{"inlineContent":[{"text":"IV","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"16"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Initialization Vector"}],"type":"paragraph"}]]],"header":"row"},{"text":"ChaCha20-Poly1305 (16 bytes)","level":5,"anchor":"ChaCha20-Poly1305-16-bytes","type":"heading"},{"header":"row","type":"table","rows":[[[{"inlineContent":[{"text":"Field","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Size (bytes)"}]}],[{"type":"paragraph","inlineContent":[{"text":"Description","type":"text"}]}]],[[{"inlineContent":[{"type":"text","text":"NONCE"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"12"}]}],[{"type":"paragraph","inlineContent":[{"text":"Nonce value","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"COUNTER"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"4"}]}],[{"inlineContent":[{"text":"Initial counter value","type":"text"}],"type":"paragraph"}]]]},{"type":"heading","text":"Version History","level":3,"anchor":"Version-History"},{"header":"row","rows":[[[{"type":"paragraph","inlineContent":[{"text":"Version","type":"text"}]}],[{"inlineContent":[{"text":"Description","type":"text"}],"type":"paragraph"}]],[[{"type":"paragraph","inlineContent":[{"text":"0x01","type":"text"}]}],[{"inlineContent":[{"type":"text","text":"Initial version with AES-GCM support"}],"type":"paragraph"}]]],"type":"table"},{"level":3,"type":"heading","text":"Format Details","anchor":"Format-Details"},{"anchor":"Magic-Bytes","level":4,"text":"Magic Bytes","type":"heading"},{"items":[{"content":[{"inlineContent":[{"text":"Fixed value: “SECB” (0x53454342)","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Used to identify the format and detect corruption"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"ASCII encoded for easy identification"}]}]}],"type":"unorderedList"},{"type":"heading","anchor":"Version-Byte","text":"Version Byte","level":4},{"items":[{"content":[{"inlineContent":[{"text":"Current version: 0x01","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Future versions must maintain backward compatibility","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Readers must reject higher versions they don’t understand"}],"type":"paragraph"}]}],"type":"unorderedList"},{"type":"heading","anchor":"Algorithm-ID","level":4,"text":"Algorithm ID"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Single byte identifier for the cipher algorithm"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Defines required parameters and authentication tag presence"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Reserved ranges:"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"0x00: Reserved"}]}]},{"content":[{"inlineContent":[{"text":"0x01-0x0F: AES variants","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"0x10-0x1F: ChaCha20 variants","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"0x20-0xFF: Reserved for future use","type":"text"}]}]}],"type":"unorderedList"}]}],"type":"unorderedList"},{"type":"heading","text":"Parameters Length","level":4,"anchor":"Parameters-Length"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"2-byte unsigned integer (big-endian)","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Maximum parameter size: 65535 bytes","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Must match the expected size for the algorithm","type":"text"}]}]}]},{"level":4,"anchor":"Authentication-Tag","type":"heading","text":"Authentication Tag"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Only present for authenticated ciphers (GCM, Poly1305)"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Always appears at the end of the ciphertext","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Size determined by algorithm and parameters"}],"type":"paragraph"}]}],"type":"unorderedList"}]}],"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/mbsecurecrypto\/cipherformat"]},{"paths":["\/documentation\/mbsecurecrypto\/cipherformat"],"traits":[{"interfaceLanguage":"occ"}]}],"metadata":{"title":"Cipher Format","role":"article","roleHeading":"Article","modules":[{"name":"MbSecureCrypto"}]},"identifier":{"url":"doc:\/\/MbSecureCrypto\/documentation\/MbSecureCrypto\/CipherFormat","interfaceLanguage":"swift"},"sections":[],"schemaVersion":{"major":0,"patch":0,"minor":3},"kind":"article","hierarchy":{"paths":[["doc:\/\/MbSecureCrypto\/documentation\/MbSecureCrypto"]]},"references":{"doc://MbSecureCrypto/documentation/MbSecureCrypto":{"kind":"symbol","title":"MbSecureCrypto","url":"\/documentation\/mbsecurecrypto","role":"collection","type":"topic","identifier":"doc:\/\/MbSecureCrypto\/documentation\/MbSecureCrypto","abstract":[{"text":"A secure cryptography library for iOS and macOS that provides cryptographically secure random number generation and encryption capabilities.","type":"text"}]}},"variantOverrides":[{"patch":[{"value":"occ","op":"replace","path":"\/identifier\/interfaceLanguage"},{"op":"add","path":"\/topicSections","value":null},{"path":"\/seeAlsoSections","op":"add","value":null}],"traits":[{"interfaceLanguage":"occ"}]}]}