{"primaryContentSections":[{"kind":"content","content":[{"text":"Format V0 Specification","anchor":"Format-V0-Specification","type":"heading","level":2},{"inlineContent":[{"type":"text","text":"Format V0 (Default)"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"text":"Used in versions 0.3.0 and earlier","type":"text"}]},{"inlineContent":[{"type":"text","text":"The V0 format is structured as follows:"}],"type":"paragraph"},{"syntax":null,"code":["[12-byte nonce][ciphertext][16-byte tag]"],"type":"codeListing"},{"inlineContent":[{"text":"Key characteristics:","type":"text"}],"type":"paragraph"},{"items":[{"content":[{"inlineContent":[{"text":"Nonce: 12 bytes, randomly generated","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Total overhead: 28 bytes per encrypted output","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Base64 encoded for string operations"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Raw bytes for data\/file operations"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"No explicit version or algorithm indicators"}],"type":"paragraph"}]}],"type":"unorderedList"},{"type":"heading","text":"Format V1 Specification","anchor":"Format-V1-Specification","level":2},{"anchor":"Format-Structure","level":3,"type":"heading","text":"Format Structure"},{"type":"paragraph","inlineContent":[{"type":"text","text":"The cipher format consists of the following components in order:"}]},{"code":["[MAGIC_BYTES (4)][VERSION (1)][ALGORITHM (1)][PARAMS_LENGTH (2)][ALGORITHM_PARAMS (variable)][CIPHERTEXT (variable)][AUTH_TAG (optional)]"],"type":"codeListing","syntax":null},{"text":"Header Format (Fixed 8 bytes)","type":"heading","anchor":"Header-Format-Fixed-8-bytes","level":4},{"rows":[[[{"inlineContent":[{"type":"text","text":"Field"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"Size (bytes)","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Description"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"MAGIC_BYTES"}]}],[{"inlineContent":[{"type":"text","text":"4"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"ASCII “SECB” (SECure Block)","type":"text"}]}]],[[{"inlineContent":[{"text":"VERSION","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"text":"1","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Format version (current: 0x01)"}]}]],[[{"inlineContent":[{"type":"text","text":"ALGORITHM"}],"type":"paragraph"}],[{"inlineContent":[{"text":"1","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"text":"Algorithm identifier","type":"text"}],"type":"paragraph"}]],[[{"inlineContent":[{"text":"PARAMS_LENGTH","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"2"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Length of algorithm parameters (big-endian)"}]}]]],"type":"table","header":"row"},{"level":4,"type":"heading","text":"Algorithm Identifiers","anchor":"Algorithm-Identifiers"},{"rows":[[[{"type":"paragraph","inlineContent":[{"type":"text","text":"Algorithm"}]}],[{"type":"paragraph","inlineContent":[{"text":"ID","type":"text"}]}],[{"inlineContent":[{"text":"IV Required","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Auth Tag"}]}],[{"inlineContent":[{"type":"text","text":"Description"}],"type":"paragraph"}]],[[{"inlineContent":[{"type":"text","text":"AES-GCM"}],"type":"paragraph"}],[{"inlineContent":[{"text":"0x01","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"Yes","type":"text"}]}],[{"inlineContent":[{"type":"text","text":"Yes"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"AES in GCM mode","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"AES-CBC"}]}],[{"inlineContent":[{"type":"text","text":"0x02"}],"type":"paragraph"}],[{"inlineContent":[{"text":"Yes","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"No"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"AES in CBC mode"}]}]],[[{"inlineContent":[{"type":"text","text":"AES-CTR"}],"type":"paragraph"}],[{"inlineContent":[{"text":"0x03","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Yes"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"No"}]}],[{"inlineContent":[{"text":"AES in CTR mode","type":"text"}],"type":"paragraph"}]],[[{"inlineContent":[{"type":"text","text":"ChaCha20-Poly1305"}],"type":"paragraph"}],[{"inlineContent":[{"text":"0x11","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Yes"}]}],[{"type":"paragraph","inlineContent":[{"text":"Yes","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"ChaCha20 with Poly1305"}]}]]],"type":"table","header":"row"},{"anchor":"Algorithm-Parameters","level":4,"text":"Algorithm Parameters","type":"heading"},{"level":5,"text":"AES-GCM (16 bytes)","anchor":"AES-GCM-16-bytes","type":"heading"},{"rows":[[[{"type":"paragraph","inlineContent":[{"text":"Field","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Size (bytes)"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Description"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"IV"}]}],[{"inlineContent":[{"text":"12","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"Initialization Vector","type":"text"}]}]],[[{"inlineContent":[{"type":"text","text":"TAG_LENGTH"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"4"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Auth tag length in bits"}]}]]],"type":"table","header":"row"},{"anchor":"AES-CBC-16-bytes","type":"heading","text":"AES-CBC (16 bytes)","level":5},{"type":"table","header":"row","rows":[[[{"inlineContent":[{"text":"Field","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"Size (bytes)","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"text":"Description","type":"text"}]}]],[[{"type":"paragraph","inlineContent":[{"text":"IV","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"16"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Initialization Vector"}]}]]]},{"level":5,"text":"ChaCha20-Poly1305 (16 bytes)","anchor":"ChaCha20-Poly1305-16-bytes","type":"heading"},{"rows":[[[{"inlineContent":[{"type":"text","text":"Field"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"Size (bytes)","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Description"}]}]],[[{"inlineContent":[{"type":"text","text":"NONCE"}],"type":"paragraph"}],[{"inlineContent":[{"text":"12","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Nonce value"}]}]],[[{"inlineContent":[{"type":"text","text":"COUNTER"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"4"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Initial counter value"}]}]]],"header":"row","type":"table"},{"type":"heading","level":3,"text":"Version History","anchor":"Version-History"},{"header":"row","rows":[[[{"type":"paragraph","inlineContent":[{"type":"text","text":"Version"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"Description"}]}]],[[{"inlineContent":[{"text":"0x01","type":"text"}],"type":"paragraph"}],[{"type":"paragraph","inlineContent":[{"text":"Initial version with AES-GCM support","type":"text"}]}]]],"type":"table"},{"level":3,"text":"Format Details","type":"heading","anchor":"Format-Details"},{"anchor":"Magic-Bytes","text":"Magic Bytes","type":"heading","level":4},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"Fixed value: “SECB” (0x53454342)","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Used to identify the format and detect corruption"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"ASCII encoded for easy identification","type":"text"}]}]}]},{"type":"heading","level":4,"text":"Version Byte","anchor":"Version-Byte"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"Current version: 0x01"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Future versions must maintain backward compatibility","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Readers must reject higher versions they don’t understand"}]}]}]},{"type":"heading","level":4,"anchor":"Algorithm-ID","text":"Algorithm ID"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Single byte identifier for the cipher algorithm"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Defines required parameters and authentication tag presence"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Reserved ranges:"}],"type":"paragraph"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"0x00: Reserved"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"0x01-0x0F: AES variants","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"0x10-0x1F: ChaCha20 variants"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"0x20-0xFF: Reserved for future use"}],"type":"paragraph"}]}],"type":"unorderedList"}]}]},{"text":"Parameters Length","anchor":"Parameters-Length","type":"heading","level":4},{"items":[{"content":[{"inlineContent":[{"text":"2-byte unsigned integer (big-endian)","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Maximum parameter size: 65535 bytes","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Must match the expected size for the algorithm"}]}]}],"type":"unorderedList"},{"type":"heading","level":4,"anchor":"Authentication-Tag","text":"Authentication Tag"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Only present for authenticated ciphers (GCM, Poly1305)","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Always appears at the end of the ciphertext","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Size determined by algorithm and parameters"}],"type":"paragraph"}]}],"type":"unorderedList"}]}],"schemaVersion":{"patch":0,"minor":3,"major":0},"metadata":{"role":"article","title":"Cipher Format","modules":[{"name":"MbSecureCrypto"}],"roleHeading":"Article"},"variants":[{"paths":["\/documentation\/mbsecurecrypto\/cipherformat"],"traits":[{"interfaceLanguage":"swift"}]},{"traits":[{"interfaceLanguage":"occ"}],"paths":["\/documentation\/mbsecurecrypto\/cipherformat"]}],"sections":[],"kind":"article","identifier":{"url":"doc:\/\/MbSecureCrypto\/documentation\/MbSecureCrypto\/CipherFormat","interfaceLanguage":"swift"},"hierarchy":{"paths":[["doc:\/\/MbSecureCrypto\/documentation\/MbSecureCrypto"]]},"references":{"doc://MbSecureCrypto/documentation/MbSecureCrypto":{"title":"MbSecureCrypto","kind":"symbol","abstract":[{"type":"text","text":"A secure cryptography library for iOS and macOS that provides cryptographically secure random number generation and encryption capabilities."}],"role":"collection","url":"\/documentation\/mbsecurecrypto","identifier":"doc:\/\/MbSecureCrypto\/documentation\/MbSecureCrypto","type":"topic"}},"variantOverrides":[{"patch":[{"op":"replace","path":"\/identifier\/interfaceLanguage","value":"occ"},{"op":"add","path":"\/topicSections","value":null},{"path":"\/seeAlsoSections","value":null,"op":"add"}],"traits":[{"interfaceLanguage":"occ"}]}]}